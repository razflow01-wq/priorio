<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Priorio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, #0a3cff, #ff2d2d);
  color: white;
  min-height: 100vh;
}
.container {
  max-width: 900px;
  margin: auto;
  padding: 30px;
  background: rgba(255,255,255,0.12);
  border-radius: 20px;
  margin-top: 40px;
}
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
button {
  padding: 12px 18px;
  border: none;
  border-radius: 10px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}
.btn {
  background: white;
  color: #0a3cff;
}
.btn-red {
  background: #ff2d2d;
  color: white;
}
input {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  border: none;
  margin-top: 12px;
  font-size: 16px;
}
.task {
  background: rgba(255,255,255,0.2);
  padding: 14px;
  border-radius: 12px;
  margin-top: 10px;
}
.priority {
  border: 2px solid gold;
}
.hidden {
  display: none;
}
progress {
  width: 100%;
  height: 20px;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="container" id="login">
  <h1>Bienvenue sur Priorio</h1>
  <p>Concentre-toi sur l‚Äôessentiel.</p>

  <input id="email" type="email" placeholder="Email">
  <input id="password" type="password" placeholder="Mot de passe">

  <button class="btn" onclick="register()">Cr√©er un compte</button>
  <button class="btn" onclick="login()">Se connecter</button>

  <hr style="margin:20px 0">

  <button class="btn" onclick="loginWithGoogle()">Se connecter avec Google</button>

  <p id="error" style="color:yellow;"></p>
</div>

<!-- APP -->
<div class="container hidden" id="app">

<header>
  <div>
    <h1>Priorio</h1>
    <p id="date"></p>
  </div>
  <button class="btn-red" onclick="logout()">D√©connexion</button>
</header>

<h2>üß† Tout ce que j‚Äôai √† faire</h2>
<input id="taskInput" placeholder="√âcris tout ce qui te passe par la t√™te‚Ä¶">
<button class="btn" onclick="addTask()">Ajouter</button>

<h2>üìã T√¢ches</h2>
<div id="tasks"></div>

<h2>üéØ Mes 3 priorit√©s aujourd‚Äôhui</h2>
<div id="priorities"></div>

<h2>üìà Progression</h2>
<progress id="progress" value="0" max="100"></progress>

</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyD7Bstrypdg-Xgy1K1XeCuFVKJBNkAKPBU",
  authDomain: "priorio-e8ca2.firebaseapp.com",
  projectId: "priorio-e8ca2",
  appId: "1:907107431858:web:cf07bf003c1cee116c60ab"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

/* AUTH */
function register() {
  auth.createUserWithEmailAndPassword(
    email.value, password.value
  ).catch(e => error.innerText = e.message);
}

function login() {
  auth.signInWithEmailAndPassword(
    email.value, password.value
  ).catch(e => error.innerText = e.message);
}

function loginWithGoogle() {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithRedirect(provider);
}

function logout() {
  auth.signOut();
}

auth.onAuthStateChanged(user => {
  if (user) {
    login.classList.add("hidden");
    app.classList.remove("hidden");
    loadTasks();
  }
});

/* DATE */
date.innerText = new Date().toLocaleDateString("fr-FR", {
  weekday:"long", day:"numeric", month:"long"
});

/* TASKS */
let tasks = JSON.parse(localStorage.getItem("tasks") || "[]");

function save() {
  localStorage.setItem("tasks", JSON.stringify(tasks));
  render();
}

function addTask() {
  if (!taskInput.value) return;
  tasks.push({text:taskInput.value, priority:false, done:false});
  taskInput.value="";
  save();
}

function togglePriority(i) {
  if (tasks.filter(t=>t.priority).length>=3 && !tasks[i].priority) {
    alert("D√©j√† 3 priorit√©s");
    return;
  }
  tasks[i].priority=!tasks[i].priority;
  save();
}

function toggleDone(i) {
  tasks[i].done=!tasks[i].done;
  save();
}

function render() {
  tasksDiv.innerHTML="";
  priorities.innerHTML="";
  let done=0;

  tasks.forEach((t,i)=>{
    const d=document.createElement("div");
    d.className="task"+(t.priority?" priority":"");
    d.innerHTML=`
      <input type="checkbox" ${t.done?"checked":""} onchange="toggleDone(${i})">
      ${t.text}
      <button onclick="togglePriority(${i})">‚≠ê</button>
    `;
    tasksDiv.appendChild(d);
    if(t.priority){
      const p=document.createElement("div");
      p.className="task priority";
      p.textContent=t.text;
      priorities.appendChild(p);
    }
    if(t.done) done++;
  });
  progress.value = tasks.length ? done/tasks.length*100 : 0;
}

function loadTasks(){ render(); }
</script>

</body>
</html>


